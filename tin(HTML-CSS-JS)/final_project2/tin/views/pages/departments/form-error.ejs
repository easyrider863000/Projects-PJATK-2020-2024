<%- include('../../fragments/header.ejs') %>
        <main>
            <h2><%= pageTitle %></h2>
            <form method="post" action="<%= formAction %>" class="form" novalidate onsubmit="return validateForm();">
                <input type="hidden" name="_id" id="_id" value="<%= dep._id %>">
                
                <label for="name">Nazwa: <span class="symbol-required">*</span></label>
                <input type="text" name="name" id="name" required value="<%= dep.name %>" 
                <%= (formMode == 'showDetails') ? 'disabled' : '' %> class="<%= validationErrors.find(e => e.path.includes('name')) ? 'error-input' : '' %>">
                <span id="errorName" class="errors-text">
                    <% if (validationErrors.find(e => e.path.includes('name'))) { %>
                        <%= validationErrors.find(e => e.path.includes('name')).message %>
                    <% } %>
                </span>

                <label for="description">Opis: <span class="symbol-required">*</span></label>                
                <input type="text" name="description" id="description" required value="<%= dep.description %>" 
                <%= (formMode == 'showDetails') ? 'disabled' : '' %> class="<%= validationErrors.find(e => e.path.includes('description')) ? 'error-input' : '' %>">
                <span id="errorDescription" class="errors-text">
                    <% if (validationErrors.find(e => e.path.includes('description'))) { %>
                        <%= validationErrors.find(e => e.path.includes('description')).message %>
                    <% } %>
                </span>
                
                <label for="employe">Pracownik: <span class="symbol-required">*</span></label>
                <select name="employe" id="employe" required 
                    <%= (formMode == 'showDetails') ? 'disabled' : '' %> class="<%= validationErrors.find(e => e.path.includes('emp_id')) ? 'error-input' : '' %>">
                    <option value="">Nie wybrano</option>
                    <% for (let i=0; i<allEmps.length; i++) { let emp = allEmps[i]; %>
                    <option value="<%= emp._id %>" <%= (dep._id && emp._id.toString() == dep.employee._id.toString()) ? 'selected' : ''%>><%= emp.firstName + ' ' + emp.secondName %></option>
                    <% } %>
                </select>
                <span id="errorEmployeId" class="errors-text">
                    <% if (validationErrors.find(e => e.path.includes('emp_id'))) { %>
                        <%= validationErrors.find(e => e.path.includes('emp_id')).message %>
                    <% } %>
                </span>
                
                <label for="project">Projekt: <span class="symbol-required">*</span></label>
                <select name="project" id="project" required 
                    <%= (formMode == 'showDetails') ? 'disabled' : '' %> class="<%= validationErrors.find(e => e.path.includes('prj_id')) ? 'error-input' : '' %>">
                    <option value="">Nie wybrano</option>
                    <% for (let i=0; i<allPrjs.length; i++) { let prj = allPrjs[i]; %>
                        <option value="<%= prj._id %>" <%= (dep._id && prj._id.toString() == dep.projects._id.toString()) ? 'selected' : ''%>><%= prj.name %></option>
                    <% } %>
                </select>
                <span id="errorProjectId" class="errors-text">
                    <% if (validationErrors.find(e => e.path.includes('prj_id'))) { %>
                        <%= validationErrors.find(e => e.path.includes('prj_id')).message %>
                    <% } %>
                </span>

                <div class="form-buttons">
                    <p id="errorsSummary" class="errors-text"></p>
                <% if (formMode != 'showDetails') { %>
                    <input type="submit" value="<%= btnLabel %>" class="form-button-submit">
                    <a href="/departments" class="form-button-cancel">Anuluj</a>
                <% } else { %>
                    <a href="/departments" class="form-button-cancel">Powrot</a>
                <% } %>
                </div>
            </form>
        </main>
<%- include('../../fragments/footer.ejs') %>